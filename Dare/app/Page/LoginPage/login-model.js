"use strict";
var observable_1 = require("data/observable");
var Page = require("ui/frame");
var firebase = require("nativescript-plugin-firebase");
var self;
var LoginModel = (function (_super) {
    __extends(LoginModel, _super);
    function LoginModel() {
        _super.call(this);
        self = this;
        //this.set("Add", firebase.);
    }
    LoginModel.prototype.Login = function () {
        var _this = this;
        this.LoginEmail = this.get("Email");
        this.LoginPassword = this.get("Password");
        firebase.login({ type: firebase.LoginType.PASSWORD,
            email: this.LoginEmail,
            password: this.LoginPassword }).then(function (user) {
            _this.GetUsernameFromDatabase(user.uid);
        }, function (error) {
            alert("Error:" + error);
        });
    };
    LoginModel.prototype.GetUsernameFromDatabase = function (uid) {
        var user;
        var onChildEvent = function (result) {
            if (result.type === "ChildAdded") {
                if (result.value.ID == uid) {
                    Page.topmost().navigate({
                        moduleName: "Page/MainPage/Main-Page",
                        context: { Username: result.key
                        },
                        transition: {
                            name: "slideBottom",
                            duration: 380,
                            curve: "easeIn"
                        },
                        animated: true
                    });
                }
            }
        };
        // listen to changes in the /users path
        firebase.addChildEventListener(onChildEvent, "/Users");
    };
    LoginModel.prototype.SignUp = function () {
        var _this = this;
        this.LoginEmail = this.get("Email");
        this.LoginPassword = this.get("Password");
        this.LoginUsername = this.get("Username");
        firebase.createUser({ email: this.LoginEmail,
            password: this.LoginPassword }).then(function (user) {
            alert("Sucess" + _this.LoginUsername + _this.LoginEmail + "   " + _this.LoginPassword);
            firebase.setValue("Users/" + _this.LoginUsername, { 'ID': user.key, 'Score': 0 });
        }, function (error) {
            alert("Error: " + error);
        });
    };
    LoginModel.prototype.Send = function () {
        firebase.push("", "hello");
    };
    return LoginModel;
}(observable_1.Observable));
Object.defineProperty(exports, "__esModule", { value: true });
exports.default = LoginModel;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibG9naW4tbW9kZWwuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyJsb2dpbi1tb2RlbC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiO0FBQUEsMkJBQTBCLGlCQUFpQixDQUFDLENBQUE7QUFHNUMsSUFBTyxJQUFJLFdBQVcsVUFBVSxDQUFDLENBQUM7QUFDbEMsSUFBTyxRQUFRLFdBQVcsOEJBQThCLENBQUMsQ0FBQztBQUUxRCxJQUFJLElBQUksQ0FBQztBQUNUO0lBQXlCLDhCQUFVO0lBUS9CO1FBQ0ksaUJBQU8sQ0FBQztRQUNSLElBQUksR0FBRyxJQUFJLENBQUM7UUFHWiw2QkFBNkI7SUFHakMsQ0FBQztJQUVELDBCQUFLLEdBQUw7UUFBQSxpQkFhQztRQVhHLElBQUksQ0FBQyxVQUFVLEdBQUcsSUFBSSxDQUFDLEdBQUcsQ0FBQyxPQUFPLENBQUMsQ0FBQztRQUNwQyxJQUFJLENBQUMsYUFBYSxHQUFHLElBQUksQ0FBQyxHQUFHLENBQUMsVUFBVSxDQUFDLENBQUM7UUFFMUMsUUFBUSxDQUFDLEtBQUssQ0FBQyxFQUFFLElBQUksRUFBRSxRQUFRLENBQUMsU0FBUyxDQUFDLFFBQVE7WUFDbEMsS0FBSyxFQUFFLElBQUksQ0FBQyxVQUFVO1lBQ3RCLFFBQVEsRUFBRSxJQUFJLENBQUMsYUFBYSxFQUFFLENBQUMsQ0FBQyxJQUFJLENBQUMsVUFBQyxJQUFJO1lBQ3RELEtBQUksQ0FBQyx1QkFBdUIsQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLENBQUM7UUFFM0MsQ0FBQyxFQUFDLFVBQUMsS0FBSztZQUNKLEtBQUssQ0FBQyxRQUFRLEdBQUcsS0FBSyxDQUFDLENBQUM7UUFDNUIsQ0FBQyxDQUFDLENBQUM7SUFDUCxDQUFDO0lBRUQsNENBQXVCLEdBQXZCLFVBQXdCLEdBQVU7UUFDOUIsSUFBSSxJQUFJLENBQUM7UUFDVixJQUFJLFlBQVksR0FBRyxVQUFTLE1BQVU7WUFDakMsRUFBRSxDQUFDLENBQUMsTUFBTSxDQUFDLElBQUksS0FBSyxZQUFZLENBQUMsQ0FBQyxDQUFDO2dCQUMvQixFQUFFLENBQUEsQ0FBQyxNQUFNLENBQUMsS0FBSyxDQUFDLEVBQUUsSUFBSSxHQUFHLENBQUMsQ0FBQSxDQUFDO29CQUNuQyxJQUFJLENBQUMsT0FBTyxFQUFFLENBQUMsUUFBUSxDQUFDO3dCQUVwQixVQUFVLEVBQUUseUJBQXlCO3dCQUNwQyxPQUFPLEVBQUMsRUFBQyxRQUFRLEVBQUUsTUFBTSxDQUFDLEdBQUc7eUJBQ3pCO3dCQUNMLFVBQVUsRUFBRTs0QkFDUixJQUFJLEVBQUUsYUFBYTs0QkFDbkIsUUFBUSxFQUFFLEdBQUc7NEJBQ2IsS0FBSyxFQUFFLFFBQVE7eUJBQ2pCO3dCQUNGLFFBQVEsRUFBRSxJQUFJO3FCQUNiLENBQUMsQ0FBQztnQkFFQyxDQUFDO1lBQ0wsQ0FBQztRQUNSLENBQUMsQ0FBQTtRQUNGLHVDQUF1QztRQUN2QyxRQUFRLENBQUMscUJBQXFCLENBQUMsWUFBWSxFQUFFLFFBQVEsQ0FBQyxDQUFDO0lBQ3ZELENBQUM7SUFDRCwyQkFBTSxHQUFOO1FBQUEsaUJBYUM7UUFYRyxJQUFJLENBQUMsVUFBVSxHQUFHLElBQUksQ0FBQyxHQUFHLENBQUMsT0FBTyxDQUFDLENBQUM7UUFDcEMsSUFBSSxDQUFDLGFBQWEsR0FBRyxJQUFJLENBQUMsR0FBRyxDQUFDLFVBQVUsQ0FBQyxDQUFDO1FBQzFDLElBQUksQ0FBQyxhQUFhLEdBQUcsSUFBSSxDQUFDLEdBQUcsQ0FBQyxVQUFVLENBQUMsQ0FBQztRQUMxQyxRQUFRLENBQUMsVUFBVSxDQUFDLEVBQUUsS0FBSyxFQUFFLElBQUksQ0FBQyxVQUFVO1lBQzVCLFFBQVEsRUFBRSxJQUFJLENBQUMsYUFBYSxFQUFFLENBQUMsQ0FBQyxJQUFJLENBQUMsVUFBQyxJQUFJO1lBRXRELEtBQUssQ0FBQyxRQUFRLEdBQUcsS0FBSSxDQUFDLGFBQWEsR0FBSSxLQUFJLENBQUMsVUFBVSxHQUFHLEtBQUssR0FBRyxLQUFJLENBQUMsYUFBYSxDQUFDLENBQUM7WUFDckYsUUFBUSxDQUFDLFFBQVEsQ0FBQyxRQUFRLEdBQUMsS0FBSSxDQUFDLGFBQWEsRUFBQyxFQUFFLElBQUksRUFBRyxJQUFJLENBQUMsR0FBRyxFQUFDLE9BQU8sRUFBRyxDQUFDLEVBQUMsQ0FBQyxDQUFDO1FBQ2xGLENBQUMsRUFBQyxVQUFDLEtBQUs7WUFDSixLQUFLLENBQUMsU0FBUyxHQUFHLEtBQUssQ0FBQyxDQUFDO1FBQzdCLENBQUMsQ0FBQyxDQUFDO0lBQ1AsQ0FBQztJQUNELHlCQUFJLEdBQUo7UUFDSSxRQUFRLENBQUMsSUFBSSxDQUFDLEVBQUUsRUFBQyxPQUFPLENBQUMsQ0FBQztJQUM5QixDQUFDO0lBQ0wsaUJBQUM7QUFBRCxDQUFDLEFBMUVELENBQXlCLHVCQUFVLEdBMEVsQztBQUVEO2tCQUFlLFVBQVUsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydHsgT2JzZXJ2YWJsZSB9IGZyb20gXCJkYXRhL29ic2VydmFibGVcIjtcclxuaW1wb3J0IHsgT2JzZXJ2YWJsZUFycmF5IH0gZnJvbSBcImRhdGEvb2JzZXJ2YWJsZS1hcnJheVwiO1xyXG5pbXBvcnQgTGFiZWxNb2R1bGUgPSByZXF1aXJlKFwidWkvbGFiZWxcIik7XHJcbmltcG9ydCBQYWdlID0gcmVxdWlyZShcInVpL2ZyYW1lXCIpO1xyXG5pbXBvcnQgZmlyZWJhc2UgPSByZXF1aXJlKFwibmF0aXZlc2NyaXB0LXBsdWdpbi1maXJlYmFzZVwiKTtcclxuXHJcbnZhciBzZWxmO1xyXG5jbGFzcyBMb2dpbk1vZGVsIGV4dGVuZHMgT2JzZXJ2YWJsZXtcclxuXHJcbiAgIExvZ2luVXNlcm5hbWU6IHN0cmluZztcclxuICAgQWRkOiBzdHJpbmc7XHJcbiAgIG1lc3NhZ2U6IE9ic2VydmFibGU7XHJcbiAgIExvZ2luRW1haWw6IHN0cmluZztcclxuICAgTG9naW5QYXNzd29yZDogc3RyaW5nOyAgIFxyXG5cclxuICAgIGNvbnN0cnVjdG9yKCl7XHJcbiAgICAgICAgc3VwZXIoKTtcclxuICAgICAgICBzZWxmID0gdGhpcztcclxuICAgICAgICBcclxuICAgICAgIFxyXG4gICAgICAgIC8vdGhpcy5zZXQoXCJBZGRcIiwgZmlyZWJhc2UuKTtcclxuICAgICAgXHJcbiAgICAgICBcclxuICAgIH1cclxuXHJcbiAgICBMb2dpbigpe1xyXG4gICAgICAgXHJcbiAgICAgICAgdGhpcy5Mb2dpbkVtYWlsID0gdGhpcy5nZXQoXCJFbWFpbFwiKTtcclxuICAgICAgICB0aGlzLkxvZ2luUGFzc3dvcmQgPSB0aGlzLmdldChcIlBhc3N3b3JkXCIpO1xyXG4gICAgICAgIFxyXG4gICAgICAgIGZpcmViYXNlLmxvZ2luKHsgdHlwZTogZmlyZWJhc2UuTG9naW5UeXBlLlBBU1NXT1JELCBcclxuICAgICAgICAgICAgICAgICAgICAgICAgZW1haWw6IHRoaXMuTG9naW5FbWFpbCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgcGFzc3dvcmQ6IHRoaXMuTG9naW5QYXNzd29yZCB9KS50aGVuKCh1c2VyKSA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMuR2V0VXNlcm5hbWVGcm9tRGF0YWJhc2UodXNlci51aWQpO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICB9LChlcnJvcikgPT4ge1xyXG4gICAgICAgICAgICBhbGVydChcIkVycm9yOlwiICsgZXJyb3IpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIEdldFVzZXJuYW1lRnJvbURhdGFiYXNlKHVpZDpzdHJpbmcpe1xyXG4gICAgICAgIHZhciB1c2VyO1xyXG4gICAgICAgdmFyIG9uQ2hpbGRFdmVudCA9IGZ1bmN0aW9uKHJlc3VsdDphbnkpIHtcclxuICAgICAgICAgICAgaWYgKHJlc3VsdC50eXBlID09PSBcIkNoaWxkQWRkZWRcIikge1xyXG4gICAgICAgICAgICAgICAgaWYocmVzdWx0LnZhbHVlLklEID09IHVpZCl7XHJcbiAgICAgICAgUGFnZS50b3Btb3N0KCkubmF2aWdhdGUoe1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgbW9kdWxlTmFtZTogXCJQYWdlL01haW5QYWdlL01haW4tUGFnZVwiLFxyXG4gICAgICAgICAgICAgY29udGV4dDp7VXNlcm5hbWU6IHJlc3VsdC5rZXlcclxuICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIHRyYW5zaXRpb246IHtcclxuICAgICAgICAgICAgICAgIG5hbWU6IFwic2xpZGVCb3R0b21cIixcclxuICAgICAgICAgICAgICAgIGR1cmF0aW9uOiAzODAsXHJcbiAgICAgICAgICAgICAgICBjdXJ2ZTogXCJlYXNlSW5cIlxyXG4gICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgYW5pbWF0ZWQ6IHRydWVcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICB9XHJcbiAgICAvLyBsaXN0ZW4gdG8gY2hhbmdlcyBpbiB0aGUgL3VzZXJzIHBhdGhcclxuICAgIGZpcmViYXNlLmFkZENoaWxkRXZlbnRMaXN0ZW5lcihvbkNoaWxkRXZlbnQsIFwiL1VzZXJzXCIpO1xyXG4gICAgfVxyXG4gICAgU2lnblVwKCl7XHJcbiAgICAgICBcclxuICAgICAgICB0aGlzLkxvZ2luRW1haWwgPSB0aGlzLmdldChcIkVtYWlsXCIpO1xyXG4gICAgICAgIHRoaXMuTG9naW5QYXNzd29yZCA9IHRoaXMuZ2V0KFwiUGFzc3dvcmRcIik7XHJcbiAgICAgICAgdGhpcy5Mb2dpblVzZXJuYW1lID0gdGhpcy5nZXQoXCJVc2VybmFtZVwiKTtcclxuICAgICAgICBmaXJlYmFzZS5jcmVhdGVVc2VyKHsgZW1haWw6IHRoaXMuTG9naW5FbWFpbCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgcGFzc3dvcmQ6IHRoaXMuTG9naW5QYXNzd29yZCB9KS50aGVuKCh1c2VyKSA9PiB7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBhbGVydChcIlN1Y2Vzc1wiICsgdGhpcy5Mb2dpblVzZXJuYW1lICsgIHRoaXMuTG9naW5FbWFpbCArIFwiICAgXCIgKyB0aGlzLkxvZ2luUGFzc3dvcmQpO1xyXG4gICAgICAgICAgICBmaXJlYmFzZS5zZXRWYWx1ZShcIlVzZXJzL1wiK3RoaXMuTG9naW5Vc2VybmFtZSx7ICdJRCcgOiB1c2VyLmtleSwnU2NvcmUnIDogMH0pO1xyXG4gICAgICAgIH0sKGVycm9yKSA9PiB7XHJcbiAgICAgICAgICAgIGFsZXJ0KFwiRXJyb3I6IFwiICsgZXJyb3IpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG4gICAgU2VuZCgpe1xyXG4gICAgICAgIGZpcmViYXNlLnB1c2goXCJcIixcImhlbGxvXCIpO1xyXG4gICAgfVxyXG59IFxyXG5cclxuZXhwb3J0IGRlZmF1bHQgTG9naW5Nb2RlbDsiXX0=