"use strict";
var observable_1 = require("data/observable");
var Page = require("ui/frame");
var firebase = require("nativescript-plugin-firebase");
var self;
var LoginModel = (function (_super) {
    __extends(LoginModel, _super);
    function LoginModel() {
        _super.call(this);
        self = this;
        //this.set("Add", firebase.);
    }
    LoginModel.prototype.Login = function () {
        var _this = this;
        this.LoginEmail = this.get("Email");
        this.LoginPassword = this.get("Password");
        firebase.login({ type: firebase.LoginType.PASSWORD,
            email: this.LoginEmail,
            password: this.LoginPassword }).then(function (user) {
            _this.GetUsernameFromDatabase(user.uid);
        }, function (error) {
            alert("Error:" + error);
        });
    };
    LoginModel.prototype.GetUsernameFromDatabase = function (uid) {
        var user;
        var onChildEvent = function (result) {
            if (result.type === "ChildAdded") {
                if (result.value.ID == uid) {
                    Page.topmost().navigate({
                        moduleName: "Page/MainPage/Main-Page",
                        context: { Username: result.key
                        },
                        transition: {
                            name: "slideBottom",
                            duration: 380,
                            curve: "easeIn"
                        },
                        animated: true
                    });
                }
            }
        };
        // listen to changes in the /users path
        firebase.addChildEventListener(onChildEvent, "/Users");
    };
    LoginModel.prototype.SignUp = function () {
        var _this = this;
        this.LoginEmail = this.get("Email");
        this.LoginPassword = this.get("Password");
        this.LoginUsername = this.get("Username");
        firebase.createUser({ email: this.LoginEmail,
            password: this.LoginPassword }).then(function (user) {
            alert("Sucess" + _this.LoginUsername + _this.LoginEmail + "   " + _this.LoginPassword);
            firebase.setValue("Users/" + _this.LoginUsername, { 'ID': user.key, 'Score': 0 });
        }, function (error) {
            alert("Error: " + error);
        });
    };
    LoginModel.prototype.Send = function () {
        firebase.push("", "hello");
    };
    return LoginModel;
}(observable_1.Observable));
Object.defineProperty(exports, "__esModule", { value: true });
exports.default = LoginModel;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibG9naW4tbW9kZWwuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyJsb2dpbi1tb2RlbC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiO0FBQUEsMkJBQTBCLGlCQUFpQixDQUFDLENBQUE7QUFHNUMsSUFBTyxJQUFJLFdBQVcsVUFBVSxDQUFDLENBQUM7QUFDbEMsSUFBTyxRQUFRLFdBQVcsOEJBQThCLENBQUMsQ0FBQztBQUUxRCxJQUFJLElBQUksQ0FBQztBQUNUO0lBQXlCLDhCQUFVO0lBUS9CO1FBQ0ksaUJBQU8sQ0FBQztRQUNSLElBQUksR0FBRyxJQUFJLENBQUM7UUFHWiw2QkFBNkI7SUFHakMsQ0FBQztJQUVELDBCQUFLLEdBQUw7UUFBQSxpQkFhQztRQVhHLElBQUksQ0FBQyxVQUFVLEdBQUcsSUFBSSxDQUFDLEdBQUcsQ0FBQyxPQUFPLENBQUMsQ0FBQztRQUNwQyxJQUFJLENBQUMsYUFBYSxHQUFHLElBQUksQ0FBQyxHQUFHLENBQUMsVUFBVSxDQUFDLENBQUM7UUFFMUMsUUFBUSxDQUFDLEtBQUssQ0FBQyxFQUFFLElBQUksRUFBRSxRQUFRLENBQUMsU0FBUyxDQUFDLFFBQVE7WUFDbEMsS0FBSyxFQUFFLElBQUksQ0FBQyxVQUFVO1lBQ3RCLFFBQVEsRUFBRSxJQUFJLENBQUMsYUFBYSxFQUFFLENBQUMsQ0FBQyxJQUFJLENBQUMsVUFBQyxJQUFJO1lBQ3RELEtBQUksQ0FBQyx1QkFBdUIsQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLENBQUM7UUFFM0MsQ0FBQyxFQUFDLFVBQUMsS0FBSztZQUNKLEtBQUssQ0FBQyxRQUFRLEdBQUcsS0FBSyxDQUFDLENBQUM7UUFDNUIsQ0FBQyxDQUFDLENBQUM7SUFDUCxDQUFDO0lBRUQsNENBQXVCLEdBQXZCLFVBQXdCLEdBQVU7UUFDOUIsSUFBSSxJQUFJLENBQUM7UUFDVixJQUFJLFlBQVksR0FBRyxVQUFTLE1BQVU7WUFDakMsRUFBRSxDQUFDLENBQUMsTUFBTSxDQUFDLElBQUksS0FBSyxZQUFZLENBQUMsQ0FBQyxDQUFDO2dCQUMvQixFQUFFLENBQUEsQ0FBQyxNQUFNLENBQUMsS0FBSyxDQUFDLEVBQUUsSUFBSSxHQUFHLENBQUMsQ0FBQSxDQUFDO29CQUNuQyxJQUFJLENBQUMsT0FBTyxFQUFFLENBQUMsUUFBUSxDQUFDO3dCQUVwQixVQUFVLEVBQUUseUJBQXlCO3dCQUNwQyxPQUFPLEVBQUMsRUFBQyxRQUFRLEVBQUUsTUFBTSxDQUFDLEdBQUc7eUJBQ3pCO3dCQUNMLFVBQVUsRUFBRTs0QkFDUixJQUFJLEVBQUUsYUFBYTs0QkFDbkIsUUFBUSxFQUFFLEdBQUc7NEJBQ2IsS0FBSyxFQUFFLFFBQVE7eUJBQ2pCO3dCQUNGLFFBQVEsRUFBRSxJQUFJO3FCQUNiLENBQUMsQ0FBQztnQkFFQyxDQUFDO1lBQ0wsQ0FBQztRQUNSLENBQUMsQ0FBQTtRQUNGLHVDQUF1QztRQUN2QyxRQUFRLENBQUMscUJBQXFCLENBQUMsWUFBWSxFQUFFLFFBQVEsQ0FBQyxDQUFDO0lBQ3ZELENBQUM7SUFDRCwyQkFBTSxHQUFOO1FBQUEsaUJBYUM7UUFYRyxJQUFJLENBQUMsVUFBVSxHQUFHLElBQUksQ0FBQyxHQUFHLENBQUMsT0FBTyxDQUFDLENBQUM7UUFDcEMsSUFBSSxDQUFDLGFBQWEsR0FBRyxJQUFJLENBQUMsR0FBRyxDQUFDLFVBQVUsQ0FBQyxDQUFDO1FBQzFDLElBQUksQ0FBQyxhQUFhLEdBQUcsSUFBSSxDQUFDLEdBQUcsQ0FBQyxVQUFVLENBQUMsQ0FBQztRQUMxQyxRQUFRLENBQUMsVUFBVSxDQUFDLEVBQUUsS0FBSyxFQUFFLElBQUksQ0FBQyxVQUFVO1lBQzVCLFFBQVEsRUFBRSxJQUFJLENBQUMsYUFBYSxFQUFFLENBQUMsQ0FBQyxJQUFJLENBQUMsVUFBQyxJQUFJO1lBRXRELEtBQUssQ0FBQyxRQUFRLEdBQUcsS0FBSSxDQUFDLGFBQWEsR0FBSSxLQUFJLENBQUMsVUFBVSxHQUFHLEtBQUssR0FBRyxLQUFJLENBQUMsYUFBYSxDQUFDLENBQUM7WUFDckYsUUFBUSxDQUFDLFFBQVEsQ0FBQyxRQUFRLEdBQUMsS0FBSSxDQUFDLGFBQWEsRUFBQyxFQUFFLElBQUksRUFBRyxJQUFJLENBQUMsR0FBRyxFQUFDLE9BQU8sRUFBRyxDQUFDLEVBQUMsQ0FBQyxDQUFDO1FBQ2xGLENBQUMsRUFBQyxVQUFDLEtBQUs7WUFDSixLQUFLLENBQUMsU0FBUyxHQUFHLEtBQUssQ0FBQyxDQUFDO1FBQzdCLENBQUMsQ0FBQyxDQUFDO0lBQ1AsQ0FBQztJQUNELHlCQUFJLEdBQUo7UUFDSSxRQUFRLENBQUMsSUFBSSxDQUFDLEVBQUUsRUFBQyxPQUFPLENBQUMsQ0FBQztJQUM5QixDQUFDO0lBQ0wsaUJBQUM7QUFBRCxDQUFDLEFBMUVELENBQXlCLHVCQUFVLEdBMEVsQztBQUVEO2tCQUFlLFVBQVUsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydHsgT2JzZXJ2YWJsZSB9IGZyb20gXCJkYXRhL29ic2VydmFibGVcIjtcbmltcG9ydCB7IE9ic2VydmFibGVBcnJheSB9IGZyb20gXCJkYXRhL29ic2VydmFibGUtYXJyYXlcIjtcbmltcG9ydCBMYWJlbE1vZHVsZSA9IHJlcXVpcmUoXCJ1aS9sYWJlbFwiKTtcbmltcG9ydCBQYWdlID0gcmVxdWlyZShcInVpL2ZyYW1lXCIpO1xuaW1wb3J0IGZpcmViYXNlID0gcmVxdWlyZShcIm5hdGl2ZXNjcmlwdC1wbHVnaW4tZmlyZWJhc2VcIik7XG5cbnZhciBzZWxmO1xuY2xhc3MgTG9naW5Nb2RlbCBleHRlbmRzIE9ic2VydmFibGV7XG5cbiAgIExvZ2luVXNlcm5hbWU6IHN0cmluZztcbiAgIEFkZDogc3RyaW5nO1xuICAgbWVzc2FnZTogT2JzZXJ2YWJsZTtcbiAgIExvZ2luRW1haWw6IHN0cmluZztcbiAgIExvZ2luUGFzc3dvcmQ6IHN0cmluZzsgICBcblxuICAgIGNvbnN0cnVjdG9yKCl7XG4gICAgICAgIHN1cGVyKCk7XG4gICAgICAgIHNlbGYgPSB0aGlzO1xuICAgICAgICBcbiAgICAgICBcbiAgICAgICAgLy90aGlzLnNldChcIkFkZFwiLCBmaXJlYmFzZS4pO1xuICAgICAgXG4gICAgICAgXG4gICAgfVxuXG4gICAgTG9naW4oKXtcbiAgICAgICBcbiAgICAgICAgdGhpcy5Mb2dpbkVtYWlsID0gdGhpcy5nZXQoXCJFbWFpbFwiKTtcbiAgICAgICAgdGhpcy5Mb2dpblBhc3N3b3JkID0gdGhpcy5nZXQoXCJQYXNzd29yZFwiKTtcbiAgICAgICAgXG4gICAgICAgIGZpcmViYXNlLmxvZ2luKHsgdHlwZTogZmlyZWJhc2UuTG9naW5UeXBlLlBBU1NXT1JELCBcbiAgICAgICAgICAgICAgICAgICAgICAgIGVtYWlsOiB0aGlzLkxvZ2luRW1haWwsXG4gICAgICAgICAgICAgICAgICAgICAgICBwYXNzd29yZDogdGhpcy5Mb2dpblBhc3N3b3JkIH0pLnRoZW4oKHVzZXIpID0+IHtcbiAgICAgICAgICAgIHRoaXMuR2V0VXNlcm5hbWVGcm9tRGF0YWJhc2UodXNlci51aWQpO1xuICAgICAgICAgICAgXG4gICAgICAgIH0sKGVycm9yKSA9PiB7XG4gICAgICAgICAgICBhbGVydChcIkVycm9yOlwiICsgZXJyb3IpO1xuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBHZXRVc2VybmFtZUZyb21EYXRhYmFzZSh1aWQ6c3RyaW5nKXtcbiAgICAgICAgdmFyIHVzZXI7XG4gICAgICAgdmFyIG9uQ2hpbGRFdmVudCA9IGZ1bmN0aW9uKHJlc3VsdDphbnkpIHtcbiAgICAgICAgICAgIGlmIChyZXN1bHQudHlwZSA9PT0gXCJDaGlsZEFkZGVkXCIpIHtcbiAgICAgICAgICAgICAgICBpZihyZXN1bHQudmFsdWUuSUQgPT0gdWlkKXtcbiAgICAgICAgUGFnZS50b3Btb3N0KCkubmF2aWdhdGUoe1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBtb2R1bGVOYW1lOiBcIlBhZ2UvTWFpblBhZ2UvTWFpbi1QYWdlXCIsXG4gICAgICAgICAgICAgY29udGV4dDp7VXNlcm5hbWU6IHJlc3VsdC5rZXlcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgdHJhbnNpdGlvbjoge1xuICAgICAgICAgICAgICAgIG5hbWU6IFwic2xpZGVCb3R0b21cIixcbiAgICAgICAgICAgICAgICBkdXJhdGlvbjogMzgwLFxuICAgICAgICAgICAgICAgIGN1cnZlOiBcImVhc2VJblwiXG4gICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGFuaW1hdGVkOiB0cnVlXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICB9XG4gICAgLy8gbGlzdGVuIHRvIGNoYW5nZXMgaW4gdGhlIC91c2VycyBwYXRoXG4gICAgZmlyZWJhc2UuYWRkQ2hpbGRFdmVudExpc3RlbmVyKG9uQ2hpbGRFdmVudCwgXCIvVXNlcnNcIik7XG4gICAgfVxuICAgIFNpZ25VcCgpe1xuICAgICAgIFxuICAgICAgICB0aGlzLkxvZ2luRW1haWwgPSB0aGlzLmdldChcIkVtYWlsXCIpO1xuICAgICAgICB0aGlzLkxvZ2luUGFzc3dvcmQgPSB0aGlzLmdldChcIlBhc3N3b3JkXCIpO1xuICAgICAgICB0aGlzLkxvZ2luVXNlcm5hbWUgPSB0aGlzLmdldChcIlVzZXJuYW1lXCIpO1xuICAgICAgICBmaXJlYmFzZS5jcmVhdGVVc2VyKHsgZW1haWw6IHRoaXMuTG9naW5FbWFpbCxcbiAgICAgICAgICAgICAgICAgICAgICAgIHBhc3N3b3JkOiB0aGlzLkxvZ2luUGFzc3dvcmQgfSkudGhlbigodXNlcikgPT4ge1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBhbGVydChcIlN1Y2Vzc1wiICsgdGhpcy5Mb2dpblVzZXJuYW1lICsgIHRoaXMuTG9naW5FbWFpbCArIFwiICAgXCIgKyB0aGlzLkxvZ2luUGFzc3dvcmQpO1xuICAgICAgICAgICAgZmlyZWJhc2Uuc2V0VmFsdWUoXCJVc2Vycy9cIit0aGlzLkxvZ2luVXNlcm5hbWUseyAnSUQnIDogdXNlci5rZXksJ1Njb3JlJyA6IDB9KTtcbiAgICAgICAgfSwoZXJyb3IpID0+IHtcbiAgICAgICAgICAgIGFsZXJ0KFwiRXJyb3I6IFwiICsgZXJyb3IpO1xuICAgICAgICB9KTtcbiAgICB9XG4gICAgU2VuZCgpe1xuICAgICAgICBmaXJlYmFzZS5wdXNoKFwiXCIsXCJoZWxsb1wiKTtcbiAgICB9XG59IFxuXG5leHBvcnQgZGVmYXVsdCBMb2dpbk1vZGVsOyJdfQ==