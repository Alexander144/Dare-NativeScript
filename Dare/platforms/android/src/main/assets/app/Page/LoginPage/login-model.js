"use strict";
var observable_1 = require("data/observable");
var Page = require("ui/frame");
var firebase = require("nativescript-plugin-firebase");
var self;
var LoginModel = (function (_super) {
    __extends(LoginModel, _super);
    function LoginModel() {
        _super.call(this);
        self = this;
        //this.set("Add", firebase.);
    }
    LoginModel.prototype.Login = function () {
        var _this = this;
        this.LoginEmail = this.get("Email");
        this.LoginPassword = this.get("Password");
        firebase.login({ type: firebase.LoginType.PASSWORD,
            email: this.LoginEmail,
            password: this.LoginPassword }).then(function (user) {
            _this.set("Username", null);
            _this.set("Email", null);
            _this.set("Password", null);
            _this.GetUsernameFromDatabase(user.uid);
        }, function (error) {
            alert("Error:" + error);
        });
    };
    LoginModel.prototype.GetUsernameFromDatabase = function (uid) {
        var user;
        var onChildEvent = function (result) {
            if (result.type === "ChildAdded") {
                if (result.value.ID == uid) {
                    Page.topmost().navigate({
                        moduleName: "Page/MainPage/Main-Page",
                        context: { Username: result.key
                        },
                        transition: {
                            name: "slideBottom",
                            duration: 380,
                            curve: "easeIn"
                        },
                        animated: true
                    });
                }
            }
        };
        // listen to changes in the /users path
        firebase.addChildEventListener(onChildEvent, "/Users");
    };
    LoginModel.prototype.SignUp = function () {
        var _this = this;
        this.LoginEmail = this.get("Email");
        this.LoginPassword = this.get("Password");
        firebase.createUser({ email: this.LoginEmail,
            password: this.LoginPassword }).then(function (user) {
            _this.set("Username", null);
            _this.set("Email", null);
            _this.set("Password", null);
            alert("Sucess");
            firebase.setValue("Users/" + _this.get("Username"), { 'ID': user.key, 'Score': 0 });
        }, function (error) {
            alert("Error: " + error);
        });
    };
    LoginModel.prototype.Send = function () {
        firebase.push("", "hello");
    };
    return LoginModel;
}(observable_1.Observable));
Object.defineProperty(exports, "__esModule", { value: true });
exports.default = LoginModel;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibG9naW4tbW9kZWwuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyJsb2dpbi1tb2RlbC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiO0FBQUEsMkJBQTBCLGlCQUFpQixDQUFDLENBQUE7QUFHNUMsSUFBTyxJQUFJLFdBQVcsVUFBVSxDQUFDLENBQUM7QUFDbEMsSUFBTyxRQUFRLFdBQVcsOEJBQThCLENBQUMsQ0FBQztBQUUxRCxJQUFJLElBQUksQ0FBQztBQUNUO0lBQXlCLDhCQUFVO0lBUS9CO1FBQ0ksaUJBQU8sQ0FBQztRQUNSLElBQUksR0FBRyxJQUFJLENBQUM7UUFHWiw2QkFBNkI7SUFHakMsQ0FBQztJQUVELDBCQUFLLEdBQUw7UUFBQSxpQkFnQkM7UUFkRyxJQUFJLENBQUMsVUFBVSxHQUFHLElBQUksQ0FBQyxHQUFHLENBQUMsT0FBTyxDQUFDLENBQUM7UUFDcEMsSUFBSSxDQUFDLGFBQWEsR0FBRyxJQUFJLENBQUMsR0FBRyxDQUFDLFVBQVUsQ0FBQyxDQUFDO1FBRTFDLFFBQVEsQ0FBQyxLQUFLLENBQUMsRUFBRSxJQUFJLEVBQUUsUUFBUSxDQUFDLFNBQVMsQ0FBQyxRQUFRO1lBQ2xDLEtBQUssRUFBRSxJQUFJLENBQUMsVUFBVTtZQUN0QixRQUFRLEVBQUUsSUFBSSxDQUFDLGFBQWEsRUFBRSxDQUFDLENBQUMsSUFBSSxDQUFDLFVBQUMsSUFBSTtZQUN0RCxLQUFJLENBQUMsR0FBRyxDQUFDLFVBQVUsRUFBRSxJQUFJLENBQUMsQ0FBQztZQUMzQixLQUFJLENBQUMsR0FBRyxDQUFDLE9BQU8sRUFBRSxJQUFJLENBQUMsQ0FBQztZQUN4QixLQUFJLENBQUMsR0FBRyxDQUFDLFVBQVUsRUFBRSxJQUFJLENBQUMsQ0FBQztZQUMzQixLQUFJLENBQUMsdUJBQXVCLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxDQUFDO1FBRTNDLENBQUMsRUFBQyxVQUFDLEtBQUs7WUFDSixLQUFLLENBQUMsUUFBUSxHQUFHLEtBQUssQ0FBQyxDQUFDO1FBQzVCLENBQUMsQ0FBQyxDQUFDO0lBQ1AsQ0FBQztJQUVELDRDQUF1QixHQUF2QixVQUF3QixHQUFVO1FBQzlCLElBQUksSUFBSSxDQUFDO1FBQ1YsSUFBSSxZQUFZLEdBQUcsVUFBUyxNQUFVO1lBQ2pDLEVBQUUsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxJQUFJLEtBQUssWUFBWSxDQUFDLENBQUMsQ0FBQztnQkFDL0IsRUFBRSxDQUFBLENBQUMsTUFBTSxDQUFDLEtBQUssQ0FBQyxFQUFFLElBQUksR0FBRyxDQUFDLENBQUEsQ0FBQztvQkFDbkMsSUFBSSxDQUFDLE9BQU8sRUFBRSxDQUFDLFFBQVEsQ0FBQzt3QkFFcEIsVUFBVSxFQUFFLHlCQUF5Qjt3QkFDcEMsT0FBTyxFQUFDLEVBQUMsUUFBUSxFQUFFLE1BQU0sQ0FBQyxHQUFHO3lCQUN6Qjt3QkFDTCxVQUFVLEVBQUU7NEJBQ1IsSUFBSSxFQUFFLGFBQWE7NEJBQ25CLFFBQVEsRUFBRSxHQUFHOzRCQUNiLEtBQUssRUFBRSxRQUFRO3lCQUNqQjt3QkFDRixRQUFRLEVBQUUsSUFBSTtxQkFDYixDQUFDLENBQUM7Z0JBRUMsQ0FBQztZQUNMLENBQUM7UUFDUixDQUFDLENBQUE7UUFDRix1Q0FBdUM7UUFDdkMsUUFBUSxDQUFDLHFCQUFxQixDQUFDLFlBQVksRUFBRSxRQUFRLENBQUMsQ0FBQztJQUN2RCxDQUFDO0lBQ0QsMkJBQU0sR0FBTjtRQUFBLGlCQWNDO1FBWkcsSUFBSSxDQUFDLFVBQVUsR0FBRyxJQUFJLENBQUMsR0FBRyxDQUFDLE9BQU8sQ0FBQyxDQUFDO1FBQ3BDLElBQUksQ0FBQyxhQUFhLEdBQUcsSUFBSSxDQUFDLEdBQUcsQ0FBQyxVQUFVLENBQUMsQ0FBQztRQUMxQyxRQUFRLENBQUMsVUFBVSxDQUFDLEVBQUUsS0FBSyxFQUFFLElBQUksQ0FBQyxVQUFVO1lBQzVCLFFBQVEsRUFBRSxJQUFJLENBQUMsYUFBYSxFQUFFLENBQUMsQ0FBQyxJQUFJLENBQUMsVUFBQyxJQUFJO1lBQ3RELEtBQUksQ0FBQyxHQUFHLENBQUMsVUFBVSxFQUFFLElBQUksQ0FBQyxDQUFDO1lBQzNCLEtBQUksQ0FBQyxHQUFHLENBQUMsT0FBTyxFQUFFLElBQUksQ0FBQyxDQUFDO1lBQ3hCLEtBQUksQ0FBQyxHQUFHLENBQUMsVUFBVSxFQUFFLElBQUksQ0FBQyxDQUFDO1lBQzNCLEtBQUssQ0FBQyxRQUFRLENBQUMsQ0FBQztZQUNoQixRQUFRLENBQUMsUUFBUSxDQUFDLFFBQVEsR0FBQyxLQUFJLENBQUMsR0FBRyxDQUFDLFVBQVUsQ0FBQyxFQUFDLEVBQUUsSUFBSSxFQUFHLElBQUksQ0FBQyxHQUFHLEVBQUMsT0FBTyxFQUFHLENBQUMsRUFBQyxDQUFDLENBQUM7UUFDcEYsQ0FBQyxFQUFDLFVBQUMsS0FBSztZQUNKLEtBQUssQ0FBQyxTQUFTLEdBQUcsS0FBSyxDQUFDLENBQUM7UUFDN0IsQ0FBQyxDQUFDLENBQUM7SUFDUCxDQUFDO0lBQ0QseUJBQUksR0FBSjtRQUNJLFFBQVEsQ0FBQyxJQUFJLENBQUMsRUFBRSxFQUFDLE9BQU8sQ0FBQyxDQUFDO0lBQzlCLENBQUM7SUFDTCxpQkFBQztBQUFELENBQUMsQUE5RUQsQ0FBeUIsdUJBQVUsR0E4RWxDO0FBRUQ7a0JBQWUsVUFBVSxDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0eyBPYnNlcnZhYmxlIH0gZnJvbSBcImRhdGEvb2JzZXJ2YWJsZVwiO1xuaW1wb3J0IHsgT2JzZXJ2YWJsZUFycmF5IH0gZnJvbSBcImRhdGEvb2JzZXJ2YWJsZS1hcnJheVwiO1xuaW1wb3J0IExhYmVsTW9kdWxlID0gcmVxdWlyZShcInVpL2xhYmVsXCIpO1xuaW1wb3J0IFBhZ2UgPSByZXF1aXJlKFwidWkvZnJhbWVcIik7XG5pbXBvcnQgZmlyZWJhc2UgPSByZXF1aXJlKFwibmF0aXZlc2NyaXB0LXBsdWdpbi1maXJlYmFzZVwiKTtcblxudmFyIHNlbGY7XG5jbGFzcyBMb2dpbk1vZGVsIGV4dGVuZHMgT2JzZXJ2YWJsZXtcblxuICAgVXNlcm5hbWU6IHN0cmluZztcbiAgIEFkZDogc3RyaW5nO1xuICAgbWVzc2FnZTogT2JzZXJ2YWJsZTtcbiAgIExvZ2luRW1haWw6IHN0cmluZztcbiAgIExvZ2luUGFzc3dvcmQ6IHN0cmluZzsgICBcblxuICAgIGNvbnN0cnVjdG9yKCl7XG4gICAgICAgIHN1cGVyKCk7XG4gICAgICAgIHNlbGYgPSB0aGlzO1xuICAgICAgICBcbiAgICAgICBcbiAgICAgICAgLy90aGlzLnNldChcIkFkZFwiLCBmaXJlYmFzZS4pO1xuICAgICAgXG4gICAgICAgXG4gICAgfVxuXG4gICAgTG9naW4oKXtcbiAgICAgICBcbiAgICAgICAgdGhpcy5Mb2dpbkVtYWlsID0gdGhpcy5nZXQoXCJFbWFpbFwiKTtcbiAgICAgICAgdGhpcy5Mb2dpblBhc3N3b3JkID0gdGhpcy5nZXQoXCJQYXNzd29yZFwiKTtcbiAgICAgICAgXG4gICAgICAgIGZpcmViYXNlLmxvZ2luKHsgdHlwZTogZmlyZWJhc2UuTG9naW5UeXBlLlBBU1NXT1JELCBcbiAgICAgICAgICAgICAgICAgICAgICAgIGVtYWlsOiB0aGlzLkxvZ2luRW1haWwsXG4gICAgICAgICAgICAgICAgICAgICAgICBwYXNzd29yZDogdGhpcy5Mb2dpblBhc3N3b3JkIH0pLnRoZW4oKHVzZXIpID0+IHtcbiAgICAgICAgICAgIHRoaXMuc2V0KFwiVXNlcm5hbWVcIiwgbnVsbCk7XG4gICAgICAgICAgICB0aGlzLnNldChcIkVtYWlsXCIsIG51bGwpO1xuICAgICAgICAgICAgdGhpcy5zZXQoXCJQYXNzd29yZFwiLCBudWxsKTtcbiAgICAgICAgICAgIHRoaXMuR2V0VXNlcm5hbWVGcm9tRGF0YWJhc2UodXNlci51aWQpO1xuICAgICAgICAgICAgXG4gICAgICAgIH0sKGVycm9yKSA9PiB7XG4gICAgICAgICAgICBhbGVydChcIkVycm9yOlwiICsgZXJyb3IpO1xuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBHZXRVc2VybmFtZUZyb21EYXRhYmFzZSh1aWQ6c3RyaW5nKXtcbiAgICAgICAgdmFyIHVzZXI7XG4gICAgICAgdmFyIG9uQ2hpbGRFdmVudCA9IGZ1bmN0aW9uKHJlc3VsdDphbnkpIHtcbiAgICAgICAgICAgIGlmIChyZXN1bHQudHlwZSA9PT0gXCJDaGlsZEFkZGVkXCIpIHtcbiAgICAgICAgICAgICAgICBpZihyZXN1bHQudmFsdWUuSUQgPT0gdWlkKXtcbiAgICAgICAgUGFnZS50b3Btb3N0KCkubmF2aWdhdGUoe1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBtb2R1bGVOYW1lOiBcIlBhZ2UvTWFpblBhZ2UvTWFpbi1QYWdlXCIsXG4gICAgICAgICAgICAgY29udGV4dDp7VXNlcm5hbWU6IHJlc3VsdC5rZXlcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgdHJhbnNpdGlvbjoge1xuICAgICAgICAgICAgICAgIG5hbWU6IFwic2xpZGVCb3R0b21cIixcbiAgICAgICAgICAgICAgICBkdXJhdGlvbjogMzgwLFxuICAgICAgICAgICAgICAgIGN1cnZlOiBcImVhc2VJblwiXG4gICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGFuaW1hdGVkOiB0cnVlXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICB9XG4gICAgLy8gbGlzdGVuIHRvIGNoYW5nZXMgaW4gdGhlIC91c2VycyBwYXRoXG4gICAgZmlyZWJhc2UuYWRkQ2hpbGRFdmVudExpc3RlbmVyKG9uQ2hpbGRFdmVudCwgXCIvVXNlcnNcIik7XG4gICAgfVxuICAgIFNpZ25VcCgpe1xuICAgICAgIFxuICAgICAgICB0aGlzLkxvZ2luRW1haWwgPSB0aGlzLmdldChcIkVtYWlsXCIpO1xuICAgICAgICB0aGlzLkxvZ2luUGFzc3dvcmQgPSB0aGlzLmdldChcIlBhc3N3b3JkXCIpO1xuICAgICAgICBmaXJlYmFzZS5jcmVhdGVVc2VyKHsgZW1haWw6IHRoaXMuTG9naW5FbWFpbCxcbiAgICAgICAgICAgICAgICAgICAgICAgIHBhc3N3b3JkOiB0aGlzLkxvZ2luUGFzc3dvcmQgfSkudGhlbigodXNlcikgPT4ge1xuICAgICAgICAgICAgdGhpcy5zZXQoXCJVc2VybmFtZVwiLCBudWxsKTtcbiAgICAgICAgICAgIHRoaXMuc2V0KFwiRW1haWxcIiwgbnVsbCk7XG4gICAgICAgICAgICB0aGlzLnNldChcIlBhc3N3b3JkXCIsIG51bGwpO1xuICAgICAgICAgICAgYWxlcnQoXCJTdWNlc3NcIik7XG4gICAgICAgICAgICBmaXJlYmFzZS5zZXRWYWx1ZShcIlVzZXJzL1wiK3RoaXMuZ2V0KFwiVXNlcm5hbWVcIikseyAnSUQnIDogdXNlci5rZXksJ1Njb3JlJyA6IDB9KTtcbiAgICAgICAgfSwoZXJyb3IpID0+IHtcbiAgICAgICAgICAgIGFsZXJ0KFwiRXJyb3I6IFwiICsgZXJyb3IpO1xuICAgICAgICB9KTtcbiAgICB9XG4gICAgU2VuZCgpe1xuICAgICAgICBmaXJlYmFzZS5wdXNoKFwiXCIsXCJoZWxsb1wiKTtcbiAgICB9XG59IFxuXG5leHBvcnQgZGVmYXVsdCBMb2dpbk1vZGVsOyJdfQ==